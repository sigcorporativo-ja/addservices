!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){e.exports='<div class="m-control m-addservices-container">\n    <div id="m-searching-result-addservices" class="m-searching-result g-cartografia-spinner"></div>\n    <div class="title">Cargar servicios WMS</div>\n    \x3c!--         <div id="m-addservices-search" class="search-panel form">\n            <input id="m-addservice-url" type="text" placeholder="URL del servicio" />\n            <button id="m-addservices-btnurl" class="g-cartografia-mas2" title="Añadir WMS"></button>\n        </div> --\x3e\n    \x3c!-- search panel --\x3e\n    <div class="search-panel">\n        <input type="text" id="m-addservices-search-input" placeholder="URL del servicio" class="m-input-search" />\n        <button id="m-addservices-search-btn" class="g-cartografia-zoom m-search-btn" title="Conectar al servicio WMS"></button>\n        <button id="m-addservices-clear-btn" class="g-cartografia-cancelar m-clear-btn" title="Limpiar búsqueda"></button>\n    </div>\n    <div id="m-addservices-results"></div>\n</div>'},function(e,t){e.exports='<div class="results-panels">\n    <div class="table-results">\n        <table>\n            <thead>\n                <tr>\n                    <th>Capa</th>\n                    <th id="m-addservices-selectall">Seleccionar todas</th>\n                </tr>\n            </thead>\n            <tbody>\n                {{#each result}}\n                <tr>\n                    <td>{{name}}</td>\n                    <td><span id={{name}} class="m-check-addservices g-cartografia-check2"></span></td>\n                </tr>\n                {{/each}}\n            </tbody>\n        </table>\n        <div class="button">\n            <button class="m-addservices-add"><i class="g-cartografia-subir"></i>Añadir</button>\n        </div>\n    </div>\n</div>'},function(e,t,n){},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.r(t);var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(u,M.impl.Control);var t,n,r,l=c(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=l.call(this)).facadeMap_=null,e}return t=u,(n=[{key:"addTo",value:function(e,t){this.facadeMap_=e,o(s(u.prototype),"addTo",this).call(this,e,t)}},{key:"activate",value:function(){M.dialog.info("Hello World!")}},{key:"deactivate",value:function(){M.dialog.info("Bye World!")}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this)}}])&&i(t.prototype,n),r&&i(t,r),u}(),f=n(0),d=n.n(f),p=n(1),v=n.n(p);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_(e);if(t){var i=_(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}function g(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(o,M.Control);var t,n,r,i=b(o);function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),M.utils.isUndefined(u)&&M.exception("La implementación usada no puede crear controles PluginControl");var t=new u;return(e=i.call(this,t,A.NAME)).urlService_=null,e.btnAddUrl_=null,e.btnClear_=null,e.facadeMap_=null,e.containerAddservices_=null,e.containerSearching_=null,e.containerResults_=null,e.containerSearch_=null,e.capabilities_=null,e.stateSelectAll_=!1,e}return t=o,(n=[{key:"addEvents",value:function(e){var t=this;this.urlService_=e.getElementsByTagName("input")["m-addservices-search-input"],this.btnAddUrl_=e.getElementsByTagName("button")["m-addservices-search-btn"],this.btnClear_=e.getElementsByTagName("button")["m-addservices-clear-btn"],this.containerAddservices_=e,this.containerSearching_=e.getElementsByTagName("div")["m-searching-result-addservices"],this.containerResults_=e.getElementsByTagName("div")["m-addservices-results"],this.containerSearch_=e.getElementsByTagName("div")["m-addservices-search"],this.btnAddUrl_.addEventListener("click",(function(e){return t.readCapabilities_(e)})),this.btnClear_.addEventListener("click",(function(e){return t.removeContains_(e)}))}},{key:"createView",value:function(e){var t=this;return this.facadeMap_=e,M.template.compileSync||(M.template.compileSync=function(e,t){var n,r={};M.utils.isUndefined(t)||(r=M.utils.extends(r,t.vars),n=t.parseToHtml);var i=Handlebars.compile(e)(r);return!1!==n?M.utils.stringToHtml(i):i}),new Promise((function(e,n){var r=M.template.compileSync(d.a);t.addEvents(r),e(r)}))}},{key:"readCapabilities_",value:function(e){var t=this;e.preventDefault(),M.utils.isNullOrEmpty(this.urlService_.value)?M.dialog.error("Los campos están vacíos."):M.utils.isUrl(this.urlService_.value)?(this.containerAddservices_.classList.add("m-searching"),M.remote.get(M.utils.getWMSGetCapabilitiesUrl(this.urlService_.value)).then((function(e){try{var n=(new M.impl.format.WMSCapabilities).read(e.xml),r=new M.impl.GetCapabilities(n,t.urlService_.value,t.facadeMap_.getProjection().code);t.capabilities_=r.getLayers(),t.showResults_()}catch(e){M.dialog.error("Ha ocurrido un error al obtener el documento GetCapabilities.")}t.containerAddservices_.classList.remove("m-searching")}))):M.dialog.error("Debes indicar una URL válida.")}},{key:"showResults_",value:function(){var e=this,t=[];this.capabilities_.forEach((function(e){t.push(e.getImpl())}));var n=M.template.compileSync(v.a,{vars:{result:t}});this.containerResults_.innerHTML=n.innerHTML,M.utils.enableTouchScroll(this.containerResults_);for(var r=this.containerResults_.getElementsByTagName("span"),i=0,o=r.length;i<o;i++)r[i].addEventListener("click",(function(t){return e.registerCheck_(t)}));this.containerResults_.getElementsByTagName("th")["m-addservices-selectall"].addEventListener("click",(function(t){return e.registerCheck_(t)})),this.containerResults_.getElementsByClassName("m-addservices-add")[0].addEventListener("click",(function(t){return e.addLayers_(t)}))}},{key:"registerCheck_",value:function(e){e=e||window.event,!M.utils.isNullOrEmpty(e.target)&&e.target.classList.contains("m-check-addservices")?(e.stopPropagation(),e.target.classList.toggle("g-cartografia-check2"),e.target.classList.toggle("g-cartografia-check3"),this.containerResults_.querySelectorAll(".g-cartografia-check3").length?this.containerResults_.querySelectorAll(".g-cartografia-check2").length||(this.stateSelectAll_=!0):this.stateSelectAll_=!1):M.utils.isNullOrEmpty(e.target)||"m-addservices-selectall"!==e.target.id||(this.stateSelectAll_?(this.unSelect_(),this.stateSelectAll_=!1):(this.select_(),this.stateSelectAll_=!0))}},{key:"unSelect_",value:function(){for(var e=this.containerResults_.querySelectorAll(".g-cartografia-check3"),t=0;t<e.length;t++)e[t].classList.remove("g-cartografia-check3"),e[t].classList.add("g-cartografia-check2")}},{key:"select_",value:function(){for(var e=this.containerResults_.querySelectorAll(".g-cartografia-check2"),t=0;t<e.length;t++)e[t].classList.remove("g-cartografia-check2"),e[t].classList.add("g-cartografia-check3")}},{key:"addLayers_",value:function(e){e.preventDefault();var t=[],n=this.containerResults_.querySelectorAll(".g-cartografia-check3");if(0===n.length)M.dialog.error("Debes seleccionar al menos una capa.");else{for(var r=0,i=n.length;r<i;r++)for(var o=0,a=this.capabilities_.length;o<a;o++)n[r].id===this.capabilities_[o].legend&&(this.capabilities_[o].options.origen="WMS",t.push(this.capabilities_[o]));this.facadeMap_.addLayers(t)}}},{key:"removeContains_",value:function(e){e.preventDefault(),this.containerResults_.innerHTML="",this.urlService_.value=""}},{key:"equals",value:function(e){var t=!1;return e instanceof o&&(t=this.name===e.name),t}},{key:"getActivationButton",value:function(e){return e.querySelector("button#m-addservicescontrol-button")}}])&&y(t.prototype,n),r&&y(t,r),o}();n(2);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t,n){return t&&O(e.prototype,t),n&&O(e,n),e}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j(e);if(t){var i=j(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P(this,n)}}function P(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(n,M.Plugin);var t=E(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).map_=null,e.controls_=[],e.panel_=null,e}return k(n,null,[{key:"NAME",get:function(){return"addservices"}}]),k(n,[{key:"addTo",value:function(e){var t=this,n=new S;n.on(M.evt.ADDED_TO_MAP,(function(){t.fire(M.evt.ADDED_TO_MAP)})),this.controls_.push(n),this.map_=e,this.panel_=new M.ui.Panel(S.NAME,{collapsible:!0,className:"m-addservices",collapsedButtonClass:"g-cartografia-capas",position:M.ui.position.TR,tooltip:"Cargar WMS"}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_)}},{key:"destroy",value:function(){this.map_.removeControls(this.controls_),this.map_=null,this.controls_=null,this.panel_=null,this.name=null}}]),n}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.AddServices=A,window.M.control.AddServicesControl=S,window.M.impl.control.AddServicesControl=u}]);
//# sourceMappingURL=addservices.ol.min.js.map